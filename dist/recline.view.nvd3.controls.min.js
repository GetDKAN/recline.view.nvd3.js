/*! recline.view.nvd3 v0.1 */
this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.BaseControl=Backbone.View.extend({template:'<div id="control-chart-container"><div class="recline-nvd3-query-editor"></div><div class="recline-nvd3-filter-editor"></div><div class="form-group"><label for="control-chart-x-format">X-Format</label><input value="{{xFormat}}" type="text" id="control-chart-x-format" class="form-control" placeholder="e.g: %Y"/></div><div class="form-group"><label for="control-chart-label-x-rotation">Label X Rotation</label><input value="{{options.xAxis.rotateLabels}}" type="text" id="control-chart-label-x-rotation" class="form-control" placeholder="e.g: -45"/></div><div class="form-group"><label for="control-chart-transition-time">Transition Time (milliseconds)</label><input value="{{transitionTime}}" type="text" id="control-chart-transition-time" class="form-control" placeholder="e.g: 2000"/></div><div class="form-group"><label for="control-chart-color-picker">Color</label><input type="text" class="form-control" id="control-chart-color-picker"/><input class="form-control" type="text" id="control-chart-color" value="{{options.color}}" placeholder="e.g: #FF0000,green,blue,#00FF00"/></div><div class="form-group"><label for="control-chart-x-axis-label">X Axis Label</label><input class="form-control" type="text" id="control-chart-x-axis-label" value="{{options.xAxis.axisLabel}}"/></div><div class="form-group"><label for="control-chart-x-axis-label">Y Axis Label</label><input class="form-control" type="text" id="control-chart-y-axis-label" value="{{options.yAxis.axisLabel}}"/></div><div class="form-group"><label for="control-chart-y-axis-label-distance">Y Axis Label Distance</label><input class="form-control" type="text" id="control-chart-y-axis-label-distance" value="{{options.yAxis.axisLabelDistance}}"/></div><div class="form-group"><label for="control-chart-sort">Sort</label><select id="control-chart-sort" class="form-control chosen-select">{{#sortFields}}<option value="{{value}}" {{#selected}} selected{{/selected}}>{{name}}</option>{{/sortFields}}</select></div><div class="form-group"><div class="row"><div class="col-md-12 col-sm-12"><label for="exampleInputPassword1">Margin</label></div></div><div class="row"><div class="col-md-3 col-sm-3"><input id="control-chart-margin-top" type="text" class="form-control" aria-label="" placeholder="Top" value="{{options.margin.top}}"></div><div class="col-md-3 col-sm-3"><input id="control-chart-margin-right" type="text" class="form-control" aria-label="" placeholder="Right" value="{{options.margin.right}}"></div><div class="col-md-3 col-sm-3"><input id="control-chart-margin-bottom" type="text" class="form-control" aria-label="" placeholder="Bottom" value="{{options.margin.bottom}}"></div><div class="col-md-3 col-sm-3"><input id="control-chart-margin-left" type="text" class="form-control" aria-label="" placeholder="Left" value="{{options.margin.left}}"></div></div></div><div class="form-group checkbox"><label for="control-chart-show-title"><input type="checkbox" id="control-chart-show-title" value="{{showTitle}}" {{#showTitle}}checked{{/showTitle}}/> Show title</label></div><div class="form-group checkbox"><label for="control-chart-show-controls"><input type="checkbox" id="control-chart-show-controls" value="{{options.showControls}}" {{#options.showControls}}checked{{/options.showControls}}/> Show controls</label></div><div class="form-group checkbox"><label for="control-chart-show-legend"><input type="checkbox" id="control-chart-show-legend" value="{{options.showLegend}}" {{#options.showLegend}}checked{{/options.showLegend}}/> Show legend</label></div><div class="form-group checkbox"><label for="control-chart-group"><input type="checkbox" id="control-chart-group" value="{{group}}" {{#group}}checked{{/group}}/> Group by X-Field</label></div><div class="form-group checkbox"><label for="control-chart-show-tooltips"><input type="checkbox" id="control-chart-show-tooltips" {{#options.tooltips}}checked{{/options.tooltips}}/> Show Tooltips</label></div><div class="form-group checkbox"><label for="control-chart-reduce-ticks"><input type="checkbox" id="control-chart-reduce-ticks" {{#options.reduceXTicks}}checked{{/options.reduceXTicks}}/> Reduce Ticks</label></div></div>',initialize:function(a){var b=this;b.state=a.state,b.model=a.model,b.renderQueryEditor=a.renderQueryEditor,b.renderFilterEditor=a.renderFilterEditor,b.parent=a.parent},events:{'change input[type="checkbox"]':"update","change select":"update",'blur input[type="text"]':"update",'keydown input[type="text"]':"update","submit #control-chart":"update"},render:function(){var c=this,d=_.arrayToOptions(_.getFields(c.state.get("model")));d.unshift({name:"default",label:"Default",selected:!1}),c.state.set("sortFields",_.applyOption(d,[c.state.get("sort")]));var e=c.state.get("options");e.margin=e.margin||{top:15,right:10,bottom:50,left:60},c.state.set("options",e,{silent:!0}),c.$el.html(Mustache.render(c.template,c.state.toJSON())),c.$(".chosen-select").chosen({width:"95%"}),a("#control-chart-color").on("blur",function(a){c.update(a)}),a("#control-chart-color-picker").spectrum({change:function(b){a("#control-chart-color").val(function(a,c){var d;return d=c?c+", "+b.toHexString():b.toHexString()}),a("input#control-chart-color").trigger("blur")}}),c.renderQueryEditor&&(this.queryEditor=new b.QueryEditor({el:".recline-nvd3-query-editor",model:this.model.queryState,state:this.state}),this.queryEditor.render()),c.renderFilterEditor&&(this.filterEditor=new b.FilterEditor({el:".recline-nvd3-filter-editor",model:this.model,state:this.state}))},update:function(a){var b=this,c={};if(a){if(b.$(a.target).closest(".chosen-container").length)return;if("keydown"===a.type&&13!==a.keyCode)return}c=_.merge({},b.state.toJSON(),b.getUIState()),b.state.set(c)},getUIState:function(){var a,b=this,c={group:b.$("#control-chart-group").is(":checked"),transitionTime:b.$("#control-chart-transition-time").val(),xFormat:b.$("#control-chart-x-format").val(),sort:b.$("#control-chart-sort").val(),showTitle:b.$("#control-chart-show-title").is(":checked")};c.options=c.options||{},c.options.xAxis=c.options.xAxis||{},c.options.yAxis=c.options.yAxis||{},c.options.tooltips=b.$("#control-chart-show-tooltips").is(":checked"),c.options.showControls=b.$("#control-chart-show-controls").is(":checked"),c.options.showLegend=b.$("#control-chart-show-legend").is(":checked"),c.options.reduceXTicks=b.$("#control-chart-reduce-ticks").is(":checked"),c.options.xAxis.rotateLabels=b.$("#control-chart-label-x-rotation").val(),a=_.invoke(b.$("#control-chart-color").val().split(","),"trim"),c.options.xAxis.axisLabel=b.$("#control-chart-x-axis-label").val(),c.options.yAxis.axisLabel=b.$("#control-chart-y-axis-label").val(),c.options.yAxis.axisLabelDistance=parseInt(b.$("#control-chart-y-axis-label-distance").val())||0,b.$("#control-chart-color").val()?c.options.color=a:c.options.color&&delete c.options.color;var d={top:parseInt(b.$("#control-chart-margin-top").val()),right:parseInt(b.$("#control-chart-margin-right").val()),bottom:parseInt(b.$("#control-chart-margin-bottom").val()),left:parseInt(b.$("#control-chart-margin-left").val())};return c.options.margin=d,c}}),b.QueryEditor=Backbone.View.extend({template:'       <form action="" method="GET" class="form-inline" role="form">         <div class="form-group">           <div class="input-group text-query">             <div class="input-group-btn">               <button type="button" class="btn btn-default">Go &raquo;</button>             </div>             <input class="form-control search-query" type="text" name="q" value="{{q}}" placeholder="Search data ...">           </div>         </div>       </form>     ',events:{"click button":"onFormSubmit","change input":"onFormSubmit"},initialize:function(){_.bindAll(this,"render"),this.listenTo(this.model,"change",this.render),this.render()},onFormSubmit:function(a){a.preventDefault();var b=this.$el.find(".search-query").val();this.model.set({q:b})},render:function(){var a=this.model.toJSON(),b=Mustache.render(this.template,a);this.$el.html(b)}}),b.FilterEditor=Backbone.View.extend({template:'       <div class="filters">         <div class="form-stacked js-add">           <div class="form-group">             <label>Field</label>             <select class="fields form-control">               {{#fields}}               <option value="{{id}}">{{label}}</option>               {{/fields}}             </select>           </div>           <div class="form-group">             <label>Filter type</label>             <select class="filterType form-control">               <option value="term">Value</option>               <option value="range">Range</option>               <option value="geo_distance">Geo distance</option>             </select>           </div>           <button id="add-filter-btn" type="button" class="btn btn-default">Add</button>         </div>         <div class="form-stacked js-edit">           {{#filters}}             {{{filterRender}}}           {{/filters}}           {{#filters.length}}           <button type="button" class="btn btn-default">Update</button>           {{/filters.length}}         </div>       </div>     ',filterTemplates:{term:'         <div class="filter-{{type}} filter">           <div class="form-group">             <label>               {{field}} <small>{{type}}</small>               <a class="js-remove-filter" href="#" title="Remove this filter" data-filter-id="{{id}}">&times;</a>             </label>             <input class="form-control" type="text" value="{{term}}" name="term" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />           </div>         </div>       ',range:'         <div class="filter-{{type}} filter">           <fieldset>             <div class="form-group">               <label>                 {{field}} <small>{{type}}</small>                 <a class="js-remove-filter" href="#" title="Remove this filter" data-filter-id="{{id}}">&times;</a>               </label>             </div>             <div class="form-group">               <label for="">From</label>               <input class="form-control" type="text" value="{{from}}" name="from" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />             </div>             <div class="form-group">               <label for="">To</label>               <input class="form-control" type="text" value="{{to}}" name="to" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />             </div>           </fieldset>         </div>       ',geo_distance:'         <div class="filter-{{type}} filter">           <fieldset>             <legend>               {{field}} <small>{{type}}</small>               <a class="js-remove-filter" href="#" title="Remove this filter" data-filter-id="{{id}}">&times;</a>             </legend>             <div class="form-group">               <label class="control-label" for="">Longitude</label>               <input class="input-sm" type="text" value="{{point.lon}}" name="lon" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />             </div>             <div class="form-group">               <label class="control-label" for="">Latitude</label>               <input class="input-sm" type="text" value="{{point.lat}}" name="lat" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />             </div>             <div class="form-group">               <label class="control-label" for="">Distance (km)</label>               <input class="input-sm" type="text" value="{{distance}}" name="distance" data-filter-field="{{field}}" data-filter-id="{{id}}" data-filter-type="{{type}}" />             </div>           </fieldset>         </div>       '},events:{"click .js-remove-filter":"onRemoveFilter","click .js-add-filter":"onAddFilterShow","click .js-edit button":"onTermFiltersUpdate","click #add-filter-btn":"onAddFilter"},initialize:function(){_.bindAll(this,"render"),this.listenTo(this.model.fields,"all",this.render),this.listenTo(this.model.queryState,"change change:filters:new-blank",this.render),this.render()},render:function(){var b=this,c=a.extend(!0,{},this.model.queryState.toJSON());c.filters=_.map(c.filters,function(a,b){return a.id=b,a}),c.fields=this.model.fields.toJSON(),c.filterRender=function(){return Mustache.render(b.filterTemplates[this.type],this)};var d=Mustache.render(this.template,c);this.$el.html(d)},onAddFilterShow:function(b){b.preventDefault();var c=a(b.target);c.hide(),this.$el.find(".js-add").show()},onAddFilter:function(b){b.preventDefault();var c=a(b.target).closest(".form-stacked");c.hide();var d=c.find("select.filterType").val(),e=c.find("select.fields").val();this.model.queryState.addFilter({type:d,field:e})},onRemoveFilter:function(b){b.preventDefault();var c=a(b.target),d=c.attr("data-filter-id");this.model.queryState.removeFilter(d)},onTermFiltersUpdate:function(b){var c=this;b.preventDefault();var d=c.model.queryState.get("filters"),e=a(b.target).closest(".form-stacked");_.each(e.find("input"),function(b){var c=a(b),e=c.attr("data-filter-type"),f=parseInt(c.attr("data-filter-id"),10),g=c.attr("name"),h=c.val();switch(e){case"term":d[f].term=h;break;case"range":d[f][g]=h;break;case"geo_distance":"distance"===g?d[f].distance=parseFloat(h):d[f].point[g]=parseFloat(h)}}),c.model.queryState.set({filters:d,from:0}),c.model.queryState.trigger("change")}})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.cumulativeLineChartControls=recline.View.nvd3.BaseControl.extend({})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.discreteBarChartControls=recline.View.nvd3.BaseControl.extend({template:'<div class="form-group checkbox"><label for="control-chart-stagger-labels"><input type="checkbox" id="control-chart-stagger-labels" {{#options.staggerLabels}}checked{{/options.staggerLabels}}/> Stagger Labels</label></div><div class="form-group checkbox"><label for="control-chart-show-values"><input type="checkbox" id="control-chart-show-values" {{#options.showValues}}checked{{/options.showValues}}/> Show Values</label></div>',events:{'change input[type="checkbox"]':"update"},getUIState:function(){var a=this,b={options:{}};return b.options.showValues=a.$("#control-chart-show-values").is(":checked"),b.options.staggerLabels=a.$("#control-chart-stagger-labels").is(":checked"),b}})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.lineChartControls=recline.View.nvd3.BaseControl.extend({template:'<div class="form-group checkbox"><label for="control-chart-datapoints"><input type="checkbox" id="control-chart-datapoints" {{#options.datapoints}}checked{{/options.datapoints}}/> Show data points</label></div>',events:{'change input[type="checkbox"]':"update"},getUIState:function(){var a=this,b={options:{}};return b.options.datapoints=a.$("#control-chart-datapoints").is(":checked"),b}})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.lineWithFocusChartControls=recline.View.nvd3.BaseControl.extend({template:""})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.multiBarChartControls=recline.View.nvd3.BaseControl.extend({template:'<div class="form-group checkbox"><label for="control-chart-stagger-labels"><input type="checkbox" id="control-chart-stagger-labels" {{#options.staggerLabels}}checked{{/options.staggerLabels}}/> Stagger Labels</label></div>',events:{'change input[type="checkbox"]':"update"},getUIState:function(){var a=this,b={options:{}};return b.options.staggerLabels=a.$("#control-chart-stagger-labels").is(":checked"),b}})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.multiBarHorizontalChartControls=recline.View.nvd3.BaseControl.extend({template:""})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.pieChartControls=recline.View.nvd3.BaseControl.extend({template:'<div class="form-group checkbox"><label for="control-chart-donut"><input type="checkbox" id="control-chart-donut" {{#options.donut}}checked{{/options.donut}}/> Donut</label></div>',events:{'change input[type="checkbox"]':"update"},getUIState:function(){var a=this,b={options:{}};return b.options.donut=a.$("#control-chart-donut").is(":checked"),b}})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.scatterChartControls=recline.View.nvd3.BaseControl.extend({template:""})}(jQuery,recline.View.nvd3),this.recline=this.recline||{},this.recline.View=this.recline.View||{},function(a,b){"use strict";b.stackedAreaChartControls=recline.View.nvd3.BaseControl.extend({template:""})}(jQuery,recline.View.nvd3);